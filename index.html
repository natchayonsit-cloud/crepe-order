<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>‡∏™‡∏±‡πà‡∏á‡πÄ‡∏Ñ‡∏£‡∏õ</title>

<script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>

<style>
body {
  font-family: sans-serif;
  padding: 16px;
  background: #f7f7f7;
}

h2 {
  margin: 16px 0 8px;
}

.sheet {
  background: #fff;
  padding: 12px;
  border-radius: 10px;
  margin-bottom: 16px;
  box-shadow: 0 1px 4px rgba(0,0,0,0.1);
}

.grid-2 {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 8px 12px;
}

.option {
  border: 1px solid #ddd;
  border-radius: 8px;
  padding: 8px;
  font-size: 14px;
}

.option input {
  margin-right: 6px;
}

button {
  padding: 14px;
  font-size: 16px;
  width: 100%;
  border-radius: 8px;
  border: none;
  margin-top: 10px;
}

.btn-add {
  background: #ddd;
}

.btn-submit {
  background: #06c755;
  color: #fff;
}
</style>
</head>

<body>

<div id="sheets"></div>

<button class="btn-add" onclick="addSheet()">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏ú‡πà‡∏ô</button>
<button class="btn-submit" onclick="sendOrder()">üßæ ‡∏™‡∏£‡∏∏‡∏õ & ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</button>

<script>
const LIFF_ID = "2008739884-92cBWC4G";
let sheetCount = 0;

window.onload = async () => {
  await liff.init({ liffId: LIFF_ID });
  addSheet();
};

function addSheet() {
  sheetCount++;
  const div = document.createElement("div");
  div.className = "sheet";
  div.innerHTML = getSheetHTML(sheetCount);
  document.getElementById("sheets").appendChild(div);
}

function getSheetHTML(i) {
return `
<h2>ü•û ‡πÅ‡∏ú‡πà‡∏ô‡∏ó‡∏µ‡πà ${i}</h2>

<b>‡πÅ‡∏õ‡πâ‡∏á (‡πÄ‡∏•‡∏∑‡∏≠‡∏Å 1)</b>
<div class="grid-2">
<label class="option"><input type="radio" name="flour${i}" value="‡πÅ‡∏õ‡πâ‡∏á‡∏Å‡∏£‡∏≠‡∏ö|20">‡πÅ‡∏õ‡πâ‡∏á‡∏Å‡∏£‡∏≠‡∏ö (20)</label>
<label class="option"><input type="radio" name="flour${i}" value="‡πÅ‡∏õ‡πâ‡∏á‡∏ô‡∏¥‡πà‡∏°|20">‡πÅ‡∏õ‡πâ‡∏á‡∏ô‡∏¥‡πà‡∏° (20)</label>
</div>

<b>üç´ ‡πÅ‡∏¢‡∏° (‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏î‡πâ 1‚Äì2)</b>
<div class="grid-2">
${jamList(i)}
</div>

<b>üçå ‡∏ó‡πá‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á (‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏î‡πâ 1‚Äì5)</b>
<div class="grid-2">
${toppingList(i)}
</div>

<b>üßÄ ‡∏ã‡∏≠‡∏™ (‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏î‡πâ 1‚Äì3)</b>
<div class="grid-2">
${sauceList(i)}
</div>
`;
}

function jamList(i) {
const jams = [
["‡∏ä‡πá‡∏≠‡∏Å‡πÇ‡∏Å‡πÅ‡∏•‡∏ï",0],["‡∏™‡∏ï‡∏£‡∏≠‡∏ß‡πå‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏£‡∏µ",0],["‡∏ß‡∏ô‡∏¥‡∏•‡∏≤",0],["‡πÉ‡∏ö‡πÄ‡∏ï‡∏¢",0],
["‡∏™‡πâ‡∏°",0],["‡∏ä‡∏≤‡πÑ‡∏ó‡∏¢",0],["‡∏ö‡∏•‡∏π‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏£‡∏µ",0],["‡∏û‡∏£‡∏¥‡∏Å‡πÄ‡∏ú‡∏≤",0],
["‡∏ô‡∏π‡πÄ‡∏ó‡∏•‡∏•‡πà‡∏≤",15]
];
return jams.map(j =>
`<label class="option"><input type="checkbox" name="jam${i}" value="${j[0]}|${j[1]}">${j[0]} ${j[1]?`(+${j[1]})`:""}</label>`
).join("");
}

function toppingList(i) {
const t = [
["‡∏Å‡∏•‡πâ‡∏ß‡∏¢",5],["‡∏•‡∏π‡∏Å‡πÄ‡∏Å‡∏î",5],["‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ü‡∏•‡∏Å",5],["‡πÇ‡∏Å‡πÇ‡∏Å‡πâ‡∏Ñ‡∏£‡∏±‡πâ‡∏ô‡∏ä‡πå",5],["‡πÇ‡∏≠‡∏£‡∏¥‡πÇ‡∏≠‡πâ‡∏ö‡∏î",5],
["‡∏ù‡∏≠‡∏¢‡∏ó‡∏≠‡∏á",10],["‡πÄ‡∏°‡πá‡∏î‡∏°‡∏∞‡∏°‡πà‡∏ß‡∏á",10],["‡πÄ‡∏¢‡∏•‡∏•‡∏µ‡πà‡πÅ‡∏î‡∏á",10],["‡∏°‡∏≤‡∏£‡πå‡∏ä‡πÄ‡∏°‡∏•‡πÇ‡∏•",10],
["‡∏´‡∏°‡∏π‡∏´‡∏¢‡∏≠‡∏á",10],["‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏Å",10],["‡∏õ‡∏π‡∏≠‡∏±‡∏î",10],["‡∏ä‡∏µ‡∏™",10],["‡πÑ‡∏Ç‡πà",10],["‡πÅ‡∏Æ‡∏°",10]
];
return t.map(x =>
`<label class="option"><input type="checkbox" name="topping${i}" value="${x[0]}|${x[1]}">${x[0]} (+${x[1]})</label>`
).join("");
}

function sauceList(i) {
const s = ["‡∏ô‡∏°‡∏Ç‡πâ‡∏ô","‡∏ä‡πá‡∏≠‡∏Å‡πÇ‡∏Å‡πÅ‡∏•‡∏ï","‡∏ã‡∏≠‡∏™‡∏û‡∏£‡∏¥‡∏Å","‡∏°‡∏≤‡∏¢‡∏≠‡∏á‡πÄ‡∏ô‡∏™","‡∏ã‡∏≠‡∏™‡∏°‡∏∞‡πÄ‡∏Ç‡∏∑‡∏≠‡πÄ‡∏ó‡∏®","‡πÑ‡∏°‡πà‡∏£‡∏≤‡∏î‡∏ã‡∏≠‡∏™"];
return s.map(x =>
`<label class="option"><input type="checkbox" name="sauce${i}" value="${x}|0">${x}</label>`
).join("");
}

function parseItem(v) {
const [n,p] = v.split("|");
return {name:n, price:+p};
}

async function sendOrder() {
if (!liff.isInClient()) return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏õ‡∏¥‡∏î‡∏ú‡πà‡∏≤‡∏ô LINE");

let total = 0;
let text = "üßæ ‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡πÄ‡∏Ñ‡∏£‡∏õ\n";

for (let i=1;i<=sheetCount;i++) {
let flour = document.querySelector(`input[name="flour${i}"]:checked`);
if (!flour) return alert(`‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏õ‡πâ‡∏á ‡πÅ‡∏ú‡πà‡∏ô‡∏ó‡∏µ‡πà ${i}`);

let f = parseItem(flour.value);
total += f.price;

let jams=[], tops=[], sauces=[];
document.querySelectorAll(`input[name="jam${i}"]:checked`).forEach(e=>{
let x=parseItem(e.value); jams.push(x.name); total+=x.price;
});
document.querySelectorAll(`input[name="topping${i}"]:checked`).forEach(e=>{
let x=parseItem(e.value); tops.push(x.name); total+=x.price;
});
document.querySelectorAll(`input[name="sauce${i}"]:checked`).forEach(e=>{
sauces.push(e.value.split("|")[0]);
});

text += `
üçΩ ‡πÅ‡∏ú‡πà‡∏ô‡∏ó‡∏µ‡πà ${i}
ü•û ‡πÅ‡∏õ‡πâ‡∏á: ${f.name}
üç´ ‡πÅ‡∏¢‡∏°: ${jams.join(", ")||"-"}
üçå ‡∏ó‡πá‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á: ${tops.join(", ")||"-"}
üßÄ ‡∏ã‡∏≠‡∏™: ${sauces.join(", ")||"-"}
`;
}

text += `
üí∞ ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: ${total} ‡∏ö‡∏≤‡∏ó

üìå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÇ‡∏î‡∏¢‡∏™‡πÅ‡∏Å‡∏ô QR ‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á
‡∏´‡∏•‡∏±‡∏á‡∏ä‡∏≥‡∏£‡∏∞‡πÅ‡∏•‡πâ‡∏ß ‡∏£‡∏≠‡∏ó‡∏≤‡∏á‡∏£‡πâ‡∏≤‡∏ô‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏Ñ‡∏£‡∏±‡∏ö üôè
`;

await liff.sendMessages([
  // 1Ô∏è‚É£ ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏£‡∏∏‡∏õ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå
  {
    type: "text",
    text: text
  },

  // 2Ô∏è‚É£ ‡∏£‡∏π‡∏õ QR Payment
  {
    type: "image",
    originalContentUrl:
      "https://raw.githubusercontent.com/natchayonsit-cloud/crepe-order/main/1766328773945.png",
    previewImageUrl:
      "https://raw.githubusercontent.com/natchayonsit-cloud/crepe-order/main/1766328773945.png"
  }
]);

liff.closeWindow();
}
</script>

</body>
</html>

