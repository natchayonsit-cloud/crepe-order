<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>‡∏™‡∏±‡πà‡∏á‡πÄ‡∏Ñ‡∏£‡∏õ</title>

<!-- LIFF SDK -->
<script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>

<style>
body { font-family: sans-serif; padding: 16px; }
h2 { margin-top: 24px; }
button {
  padding: 14px;
  font-size: 16px;
  width: 100%;
  background: #06c755;
  color: #fff;
  border: none;
  border-radius: 8px;
}
</style>
</head>

<body>

<h2>ü•û ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏õ‡πâ‡∏á</h2>
<input type="radio" name="flour" value="‡πÅ‡∏õ‡πâ‡∏á‡∏Å‡∏£‡∏≠‡∏ö|20"> ‡πÅ‡∏õ‡πâ‡∏á‡∏Å‡∏£‡∏≠‡∏ö (20)<br>
<input type="radio" name="flour" value="‡πÅ‡∏õ‡πâ‡∏á‡∏ô‡∏¥‡πà‡∏°|20"> ‡πÅ‡∏õ‡πâ‡∏á‡∏ô‡∏¥‡πà‡∏° (20)<br>

<h2>üç´ ‡πÅ‡∏¢‡∏°</h2>
<input type="radio" name="jam" value="‡∏ô‡∏π‡πÄ‡∏ó‡∏•‡∏•‡πà‡∏≤|15"> ‡∏ô‡∏π‡πÄ‡∏ó‡∏•‡∏•‡πà‡∏≤ (+15)<br>
<input type="radio" name="jam" value="‡∏ä‡πá‡∏≠‡∏Å‡πÇ‡∏Å‡πÅ‡∏•‡∏ï|0"> ‡∏ä‡πá‡∏≠‡∏Å‡πÇ‡∏Å‡πÅ‡∏•‡∏ï<br>
<input type="radio" name="jam" value="‡∏™‡∏ï‡∏£‡∏≠‡∏ß‡πå‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏£‡∏µ|0"> ‡∏™‡∏ï‡∏£‡∏≠‡∏ß‡πå‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏£‡∏µ<br>

<h2>üçå ‡∏ó‡πá‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á</h2>
<input type="checkbox" name="topping" value="‡∏Å‡∏•‡πâ‡∏ß‡∏¢|5"> ‡∏Å‡∏•‡πâ‡∏ß‡∏¢ (+5)<br>
<input type="checkbox" name="topping" value="‡∏ä‡∏µ‡∏™|10"> ‡∏ä‡∏µ‡∏™ (+10)<br>
<input type="checkbox" name="topping" value="‡πÑ‡∏Ç‡πà|10"> ‡πÑ‡∏Ç‡πà (+10)<br>

<h2>üçØ ‡∏ã‡∏≠‡∏™</h2>
<input type="checkbox" name="sauce" value="‡∏ô‡∏°‡∏Ç‡πâ‡∏ô|0"> ‡∏ô‡∏°‡∏Ç‡πâ‡∏ô<br>
<input type="checkbox" name="sauce" value="‡∏ä‡πá‡∏≠‡∏Å‡πÇ‡∏Å‡πÅ‡∏•‡∏ï|0"> ‡∏ä‡πá‡∏≠‡∏Å‡πÇ‡∏Å‡πÅ‡∏•‡∏ï<br>

<br>
<button onclick="sendOrder()">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏™‡∏±‡πà‡∏á‡πÄ‡∏Ñ‡∏£‡∏õ</button>

<script>
const LIFF_ID = "2008739884-92cBWC4G";

window.onload = async () => {
  await liff.init({ liffId: LIFF_ID });
};

function parseItem(value) {
  const [name, price] = value.split("|");
  return { name, price: Number(price) };
}

async function sendOrder() {
  if (!liff.isInClient()) {
    alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏õ‡∏¥‡∏î‡∏ú‡πà‡∏≤‡∏ô LINE");
    return;
  }

  let total = 0;

  let flourEl = document.querySelector('input[name="flour"]:checked');
  let jamEl = document.querySelector('input[name="jam"]:checked');

  if (!flourEl) {
    alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏õ‡πâ‡∏á");
    return;
  }

  let flour = parseItem(flourEl.value);
  total += flour.price;

  let jam = jamEl ? parseItem(jamEl.value) : { name: "-", price: 0 };
  total += jam.price;

  let toppings = [];
  document.querySelectorAll('input[name="topping"]:checked').forEach(el => {
    let item = parseItem(el.value);
    toppings.push(item.name);
    total += item.price;
  });

  let sauces = [];
  document.querySelectorAll('input[name="sauce"]:checked').forEach(el => {
    let item = parseItem(el.value);
    sauces.push(item.name);
    total += item.price;
  });

  let message =
`üßæ ‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡πÄ‡∏Ñ‡∏£‡∏õ
ü•û ‡πÅ‡∏õ‡πâ‡∏á: ${flour.name} (${flour.price})
üç´ ‡πÅ‡∏¢‡∏°: ${jam.name} (${jam.price})
üçå ‡∏ó‡πá‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á: ${toppings.join(", ") || "-"}
üçØ ‡∏ã‡∏≠‡∏™: ${sauces.join(", ") || "-"}

üí∞ ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ß‡∏°: ${total} ‡∏ö‡∏≤‡∏ó
üìå ‡∏ó‡∏≤‡∏á‡∏£‡πâ‡∏≤‡∏ô‡∏à‡∏∞‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏Ñ‡∏£‡∏±‡∏ö`;

  await liff.sendMessages([
    { type: "text", text: message }
  ]);

  liff.closeWindow();
}
</script>

</body>
</html>
